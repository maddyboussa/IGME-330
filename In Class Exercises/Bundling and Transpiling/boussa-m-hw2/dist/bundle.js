(()=>{"use strict";var e,t,n,r,o,a,i,l=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(r,")")},c=Object.freeze({gain:.5,numSamples:256}),u=(new Uint8Array(c.numSamples/2),function(e){t.src=e});function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===s(t)?t:String(t)}var f,h,y=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.assign(this,{x:t,y:n,radius:r,color:o})}var t,n;return t=e,n=[{key:"draw",value:function(e){e.save(),e.fillStyle=this.color,e.beginPath(),e.arc(this.x,this.y,this.radius,0,2*Math.PI),e.closePath(),e.fill(),e.restore()}}],n&&v(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,w(r.key),r)}}function w(e){var t=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===m(t)?t:String(t)}f=y,(h=d(h="type"))in f?Object.defineProperty(f,h,{value:"arc",enumerable:!0,configurable:!0,writable:!0}):f[h]="arc";var b,p,S,T,q,k,P,M,j,A,E=function(){function e(t,n,r,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.assign(this,{x:t,y:n,width:r,height:o,color:a})}var t,n;return t=e,n=[{key:"draw",value:function(e){e.save(),e.fillStyle=this.color,e.fillRect(this.x,this.y,this.width,this.height),e.restore()}}],n&&g(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),F={visMethod:1,drawMethod:"circles"},O=Object.freeze({sound1:"media/AAA_Powerline.mp3"}),x=function(n){document.querySelector("#btn-fs").onclick=function(e){var t;console.log("goFullscreen() called"),(t=n).requestFullscreen?t.requestFullscreen():t.mozRequestFullscreen?t.mozRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()};var r=document.querySelector("#btn-play");r.onclick=function(n){"suspended"==e.state&&e.resume(),"no"==n.target.dataset.playing?(t.play(),n.target.dataset.playing="yes"):(t.pause(),n.target.dataset.playing="no")};var l=document.querySelector("#slider-volume"),c=document.querySelector("#label-volume");l.oninput=function(e){!function(e){e=Number(e),o.gain.value=e}(e.target.value),c.innerHTML=Math.round(e.target.value/2*100)},l.dispatchEvent(new Event("input")),document.querySelector("#track-select").onchange=function(e){u(e.target.value),"yes"==r.dataset.playing&&r.dispatchEvent(new MouseEvent("click"))},document.querySelector("#vis-select").onchange=function(e){F.visMethod=e.target.value},document.querySelector("#draw-select").onchange=function(e){F.drawMethod=e.target.value};var s=document.querySelector("#slider-treble"),v=document.querySelector("#label-treble");s.oninput=function(t){!function(t){t=Number(t),a.gain.setValueAtTime(t,e.currentTime)}(t.target.value),v.innerHTML=Math.round(t.target.value)},s.dispatchEvent(new Event("input"));var d=document.querySelector("#slider-bass"),f=document.querySelector("#label-bass");d.oninput=function(t){!function(t){t=Number(t),i.gain.setValueAtTime(t,e.currentTime)}(t.target.value),f.innerHTML=Math.round(t.target.value)},d.dispatchEvent(new Event("input"))},H=function e(){setTimeout(e,1e3/60),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(1==e.visMethod?T.getByteFrequencyData(q):2==e.visMethod&&T.getByteTimeDomainData(q),b.save(),b.fillStyle="black",b.globalAlpha=.1,b.fillRect(0,0,p,S),b.restore(),"circles"==e.drawMethod){b.save();for(var t=0;t<q.length;t++){var n=q[t]/255,r=n*k;j.radius=r,j.color=l(1,0,1,n),j.draw(b),A.radius=.7*r,A.draw(b)}b.restore(),b.save(),b.translate(M+400,P-40);for(var o=0;o<q.length;o++){var a=q[o]/255;b.translate(1,0),b.rotate(2*Math.PI/q.length),b.save(),b.scale(1,-1),new E(0,0,1,700*a,"white").draw(b),b.restore(),b.translate(1,0)}b.restore()}if("bars"==e.drawMethod){b.save(),b.translate(0,P);for(var i=p/q.length,c=0;c<q.length;c++){var u=q[c]/255;b.translate(i,0),b.save(),new E(0,0,10,200*u,"white").draw(b),b.save(),b.scale(1,-1),new E(0,0,10,200*u,"white").draw(b),b.restore(),b.restore(),b.translate(1,0)}b.restore()}if("lines"==e.drawMethod){b.save(),b.strokeStyle="white",b.lineWidth=1;var s=0,v=P;b.beginPath(),b.moveTo(s,v);for(var d=0;d<q.length;d++)b.lineTo(s,v-q[d]),s+=b.canvas.width/(q.length-10);b.lineTo(s-8,v),s=p,b.lineTo(s,v),b.stroke(),b.closePath(),b.restore(),b.save(),b.strokeStyle="white",b.lineWidth=1;var f=0,h=P+5;b.beginPath(),b.moveTo(f,h);for(var y=0;y<q.length;y++)b.lineTo(f,h+q[y]),f+=b.canvas.width/(q.length-10);b.lineTo(f-8,h),f=p,b.lineTo(f,h),b.stroke(),b.closePath(),b.restore(),b.save(),b.strokeStyle="white",b.lineWidth=1;var m=p,g=P;b.beginPath(),b.moveTo(m,g);for(var w=0;w<q.length;w++)b.lineTo(m,g-q[w]),m-=b.canvas.width/(q.length-10);b.lineTo(m-8,g),m=0,b.lineTo(m,g),b.stroke(),b.closePath(),b.restore(),b.save(),b.strokeStyle="white",b.lineWidth=1;var F=p,O=P+5;b.beginPath(),b.moveTo(F,O);for(var x=0;x<q.length;x++)b.lineTo(F,O+q[x]),F-=b.canvas.width/(q.length-10);b.lineTo(F-8,O),F=0,b.lineTo(F,O),b.stroke(),b.closePath(),b.restore()}}(F)};window.onload=function(){var l;console.log("window.onload called"),(l=new XMLHttpRequest).onload=function(e){console.log("In onload - HTTP Status Code = ".concat(e.target.status));var t,n=e.target.responseText;try{t=JSON.parse(n)}catch(e){return void console.log("JSON.parse() failed")}document.querySelector("title").innerHTML=t.title;for(var r,o,a=document.querySelector("#track-select"),i=0;i<t.numTracks;i++)r=t.tracks[i].file,o=t.tracks[i].track,a.innerHTML+=i<=0?'<option value="media/'.concat(r,'" selected>').concat(o,"</option>"):'<option value="media/'.concat(r,'">').concat(o,"</option>"),console.log(r,o);document.querySelector("#instructions-text").innerHTML=t.instructions},l.onerror=function(e){return console.log("In onerror - HTTP Status Code = ".concat(e.target.status))},l.open("GET","data/av-data.json"),l.send(),function(){var l,s;l=O.sound1,s=window.AudioContext||window.webkitAudioContext,e=new s,t=new Audio,u(l),n=e.createMediaElementSource(t),(r=e.createAnalyser()).fftSize=c.numSamples,(o=e.createGain()).gain.value=c.gain,(a=e.createBiquadFilter()).type="highshelf",a.frequency.setValueAtTime(1e3,e.currentTime),(i=e.createBiquadFilter()).type="lowshelf",i.frequency.setValueAtTime(1e3,e.currentTime),n.connect(a),a.connect(i),i.connect(r),r.connect(o),o.connect(e.destination);var v=document.querySelector("canvas");x(v),function(e,t){b=e.getContext("2d"),p=e.width,S=e.height,T=t,q=new Uint8Array(T.fftSize/2),j=new y(p/2,S/2,1,"white"),A=new y(p/2,S/2,1,"white"),k=S/9,P=S/2,M=S/2}(v,r),H()}()}})();